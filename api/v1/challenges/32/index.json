{"success": true, "data": {"id": 32, "name": "AES Client", "value": 200, "description": "# AES client\r\n\r\nAuthor: Francis Labelle\r\n\r\nCe d\u00e9fi se pr\u00e9sente comme votre introduction au monde de la \"vraie\" cryptographie avec le chiffrement AES. Avant de vous pr\u00e9senter les attaques sur AES, nous pensons que vous devriez apprendre \u00e0 utiliser les fonctions qui se trouvent dans votre langage de programmation favori afin d'\u00eatre capable de vous en servir. Pour ce d\u00e9fi, vous aurez donc \u00e0 \u00e9crire un client dont la t\u00e2che sera de r\u00e9aliser le chiffrement AES avec 3 modes diff\u00e9rents (ECB, CBC et CTR) avec des param\u00e8tres al\u00e9atoires: cl\u00e9, IV, compteur, donn\u00e9es...\r\n\r\nNous vous recommandons fortement de lire la documentation sur AES et ses modes avant de faire ce d\u00e9fi.\r\n\r\nLes op\u00e9rations \u00e0 r\u00e9aliser sont les suivantes (dans l'ordre):\r\n\r\n- Chiffrement ECB\r\n- D\u00e9chiffrement ECB\r\n- Chiffrement CBC\r\n- D\u00e9chiffrement CBC\r\n- Chiffrement CTR\r\n- D\u00e9chiffrement CTR\r\n\r\nTous les messages du serveur sont au format JSON. Le message contenant les donn\u00e9es pour une op\u00e9ration a le format suivant:\r\n\r\n```\r\n{\r\n    \"mode\": mode de chiffrement (string),\r\n    \"key\": cl\u00e9 de chiffrement (string hexad\u00e9cimale),\r\n    \"iv_or_counter\": IV ou compteur, selon le mode (string hexad\u00e9cimale ou null pour ECB),\r\n    \"operation\": \"encrypt\"|\"decrypt\",\r\n    \"data\": plaintext pour le chiffrement (string), et ciphertext pour le d\u00e9chiffrement (string hexad\u00e9cimale)\r\n}\r\n```\r\n\r\nNOTE: Le champ `data` aura toujours une longueur d'un multiple de 16. Vous n'avez donc pas \u00e0 vous soucier d'impl\u00e9menter un padding quelconque.\r\n\r\nATTENTION: notez que le champ data contient une string normale si l'op\u00e9ration est \"encrypt\", et une string *hexad\u00e9cimale* si l'op\u00e9ration est \"decrypt\". Vous devrez donc d\u00e9coder les donn\u00e9es avant de faire l'op\u00e9ration de d\u00e9chiffrement.\r\n\r\nPour envoyer le r\u00e9sultat de votre op\u00e9ration, envoyez la string en clair s'il s'agit d'un d\u00e9chiffrement, et envoyez la string hexad\u00e9cimale s'il s'agit d'un chiffrement. Pseudocode:\r\n\r\n```\r\n# Chiffrement\r\nciphertext = encrypt_aes(data, key, iv)\r\nserver.send(ciphertext.hex())\r\n\r\n# D\u00e9chiffrement\r\nplaintext = decrypt_aes(data, key, iv)\r\nserver.send(plaintext)\r\n```\r\n\r\nLe message envoy\u00e9 pour signaler le r\u00e9sultat d'une op\u00e9ration est le suivant:\r\n\r\n```\r\n{\r\n    \"success\": bool\r\n}\r\n```\r\n\r\nEnfin, apr\u00e8s avoir compl\u00e9t\u00e9 la derni\u00e8re op\u00e9ration, vous recevrez le message suivant:\r\n\r\n```\r\n{\r\n    \"flag\": string\r\n}\r\n```\r\n\r\n\r\n## Pr\u00e9cision pour CTR\r\nLes m\u00e9thodes utilis\u00e9es pour cr\u00e9er le compteur en CTR peuvent diff\u00e9rer d'une impl\u00e9mentation \u00e0 l'autre. Dans le contexte de ce d\u00e9fi, le compteur est simplement un entier encod\u00e9 en big-endian. C'est-\u00e0-dire qu'un compteur d'une valeur de 4 sera repr\u00e9sent\u00e9 de la fa\u00e7on suivante:\r\n\r\n`\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04`. De plus, il n'y a pas de _nonce_.\r\n\r\nServeur: `nc challenges.unitedctf.ca 3000`", "connection_info": null, "next_id": null, "category": "Crypto", "state": "visible", "max_attempts": 0, "type": "standard", "type_data": {"id": "standard", "name": "standard", "templates": {"create": "/plugins/challenges/assets/create.html", "update": "/plugins/challenges/assets/update.html", "view": "/plugins/challenges/assets/view.html"}, "scripts": {"create": "/plugins/challenges/assets/create.js", "update": "/plugins/challenges/assets/update.js", "view": "/plugins/challenges/assets/view.js"}}, "solves": 14, "solved_by_me": false, "attempts": 0, "files": [], "tags": [], "hints": [], "view": "<div class=\"modal-dialog\" role=\"document\">\n\t<div class=\"modal-content\">\n\t\t<div class=\"modal-body\">\n\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n\t\t\t\t<span aria-hidden=\"true\">&times;</span>\n\t\t\t</button>\n\t\t\t<ul class=\"nav nav-tabs\">\n\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t<a class=\"nav-link active\" href=\"#challenge\">Challenge</a>\n\t\t\t\t</li>\n\t\t\t\t\n\t\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t\t<a class=\"nav-link challenge-solves\" href=\"#solves\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t14 Solves\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\n\t\t\t</ul>\n\t\t\t<div role=\"tabpanel\">\n\t\t\t\t<div class=\"tab-content\">\n\t\t\t\t\t<div role=\"tabpanel\" class=\"tab-pane fade show active\" id=\"challenge\">\n\t\t\t\t\t\t<h2 class='challenge-name text-center pt-3'>\n\t\t\t\t\t\t\tAES Client\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<h3 class=\"challenge-value text-center\">\n\t\t\t\t\t\t\t200\n\t\t\t\t\t\t</h3>\n\n\t\t\t\t\t\t<div class=\"challenge-tags text-center\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<span class=\"challenge-desc\"><h1>AES client</h1>\n<p>Author: Francis Labelle</p>\n<p>Ce d\u00e9fi se pr\u00e9sente comme votre introduction au monde de la &quot;vraie&quot; cryptographie avec le chiffrement AES. Avant de vous pr\u00e9senter les attaques sur AES, nous pensons que vous devriez apprendre \u00e0 utiliser les fonctions qui se trouvent dans votre langage de programmation favori afin d'\u00eatre capable de vous en servir. Pour ce d\u00e9fi, vous aurez donc \u00e0 \u00e9crire un client dont la t\u00e2che sera de r\u00e9aliser le chiffrement AES avec 3 modes diff\u00e9rents (ECB, CBC et CTR) avec des param\u00e8tres al\u00e9atoires: cl\u00e9, IV, compteur, donn\u00e9es...</p>\n<p>Nous vous recommandons fortement de lire la documentation sur AES et ses modes avant de faire ce d\u00e9fi.</p>\n<p>Les op\u00e9rations \u00e0 r\u00e9aliser sont les suivantes (dans l'ordre):</p>\n<ul>\n<li>Chiffrement ECB</li>\n<li>D\u00e9chiffrement ECB</li>\n<li>Chiffrement CBC</li>\n<li>D\u00e9chiffrement CBC</li>\n<li>Chiffrement CTR</li>\n<li>D\u00e9chiffrement CTR</li>\n</ul>\n<p>Tous les messages du serveur sont au format JSON. Le message contenant les donn\u00e9es pour une op\u00e9ration a le format suivant:</p>\n<pre><code>{\n    &quot;mode&quot;: mode de chiffrement (string),\n    &quot;key&quot;: cl\u00e9 de chiffrement (string hexad\u00e9cimale),\n    &quot;iv_or_counter&quot;: IV ou compteur, selon le mode (string hexad\u00e9cimale ou null pour ECB),\n    &quot;operation&quot;: &quot;encrypt&quot;|&quot;decrypt&quot;,\n    &quot;data&quot;: plaintext pour le chiffrement (string), et ciphertext pour le d\u00e9chiffrement (string hexad\u00e9cimale)\n}\n</code></pre>\n<p>NOTE: Le champ <code>data</code> aura toujours une longueur d'un multiple de 16. Vous n'avez donc pas \u00e0 vous soucier d'impl\u00e9menter un padding quelconque.</p>\n<p>ATTENTION: notez que le champ data contient une string normale si l'op\u00e9ration est &quot;encrypt&quot;, et une string <em>hexad\u00e9cimale</em> si l'op\u00e9ration est &quot;decrypt&quot;. Vous devrez donc d\u00e9coder les donn\u00e9es avant de faire l'op\u00e9ration de d\u00e9chiffrement.</p>\n<p>Pour envoyer le r\u00e9sultat de votre op\u00e9ration, envoyez la string en clair s'il s'agit d'un d\u00e9chiffrement, et envoyez la string hexad\u00e9cimale s'il s'agit d'un chiffrement. Pseudocode:</p>\n<pre><code># Chiffrement\nciphertext = encrypt_aes(data, key, iv)\nserver.send(ciphertext.hex())\n\n# D\u00e9chiffrement\nplaintext = decrypt_aes(data, key, iv)\nserver.send(plaintext)\n</code></pre>\n<p>Le message envoy\u00e9 pour signaler le r\u00e9sultat d'une op\u00e9ration est le suivant:</p>\n<pre><code>{\n    &quot;success&quot;: bool\n}\n</code></pre>\n<p>Enfin, apr\u00e8s avoir compl\u00e9t\u00e9 la derni\u00e8re op\u00e9ration, vous recevrez le message suivant:</p>\n<pre><code>{\n    &quot;flag&quot;: string\n}\n</code></pre>\n<h2>Pr\u00e9cision pour CTR</h2>\n<p>Les m\u00e9thodes utilis\u00e9es pour cr\u00e9er le compteur en CTR peuvent diff\u00e9rer d'une impl\u00e9mentation \u00e0 l'autre. Dans le contexte de ce d\u00e9fi, le compteur est simplement un entier encod\u00e9 en big-endian. C'est-\u00e0-dire qu'un compteur d'une valeur de 4 sera repr\u00e9sent\u00e9 de la fa\u00e7on suivante:</p>\n<p><code>\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04</code>. De plus, il n'y a pas de <em>nonce</em>.</p>\n<p>Serveur: <code>nc challenges.unitedctf.ca 3000</code></p>\n</span>\n\n\t\t\t\t\t\t<span class=\"challenge-connection-info\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t<div class=\"challenge-hints hint-row row\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"row challenge-files text-center pb-3\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t<div class=\"row submit-row\">\n\t\t\t\t\t\t\t<div class=\"col-md-9 form-group\">\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<input id=\"challenge-id\" class=\"challenge-id\" type=\"hidden\" value=\"32\">\n\t\t\t\t\t\t\t\t\t<input id=\"challenge-input\" class=\"challenge-input\" type=\"text\" name=\"answer\" placeholder=\"Flag\"/>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-md-3 form-group key-submit\">\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<button id=\"challenge-submit\" class=\"challenge-submit\" type=\"submit\">\n\t\t\t\t\t\t\t\t\tSubmit\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"row notification-row\">\n\t\t\t\t\t\t\t<div class=\"col-md-12\">\n\t\t\t\t\t\t\t\t<div id=\"result-notification\" class=\"alert alert-dismissable text-center w-100\"\n\t\t\t\t\t\t\t\t\t role=\"alert\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t<strong id=\"result-message\"></strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div role=\"tabpanel\" class=\"tab-pane fade\" id=\"solves\">\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"col-md-12\">\n\t\t\t\t\t\t\t\t<table class=\"table table-striped text-center\">\n\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td><b>Name</b>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td><b>Date</b>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t<tbody id=\"challenge-solves-names\">\n\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>"}}
