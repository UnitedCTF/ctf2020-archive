{"success": true, "data": {"id": 34, "name": "AES CTR", "value": 350, "description": "# AES CTR\r\n\r\nAuthor: Francis Labelle\r\n\r\nLe mode CTR est un mode de chiffrement permettant de chiffrer des donn\u00e9es en continu (_streaming_) plut\u00f4t que par blocs comme ECB et CBC. Ainsi, il est possible de chiffrer des donn\u00e9es plus courtes qu'un bloc sans avoir \u00e0 ajouter de padding.\r\n\r\nAvec le mode CTR, on utilise AES non pas sur le texte \u00e0 chiffrer, mais sur un bloc compos\u00e9 d'un **nonce** (_number used once_, diff\u00e9rent pour chaque plaintext chiffr\u00e9) et d'un compteur qui s'incr\u00e9mente \u00e0 chaque bloc. Le r\u00e9sultat de cette op\u00e9ration est un _keystream_. On fait ensuite un XOR de chaque octet des donn\u00e9es \u00e0 chiffrer avec chaque octet du _keystream_.\r\n\r\n```\r\n# G\u00e9n\u00e9ration du keystream:\r\nkeystream = AES(nonce + compteur) # 16 premiers bytes de keystream\r\nkeystream += AES(nonce + compteur + 1) # 16 bytes de keystream suivants\r\nkeystream += AES(nonce + compteur + 2) # etc.\r\n# ...\r\n# Jusqu'\u00e0 ce que longueur(keystream) >= longueur(plaintext).\r\n\r\n# Chiffrement des donn\u00e9es\r\nPour chaque byte de plaintext (p) et de keystream (k):\r\n    ciphertext += p ^ k\r\n```\r\n\r\nLa s\u00e9curit\u00e9 de ce mode repose sur la s\u00e9curit\u00e9 du _keystream_. Cette s\u00e9curit\u00e9 est assur\u00e9e par le compteur et le _nonce_: le compteur s'assure que les blocs du _keystream_ seront diff\u00e9rents les uns des autres. Le _nonce_ s'assure que le _keystream_ au complet sera diff\u00e9rent pour chaque _plaintext_ \u00e0 chiffrer, tant et aussi longtemps que chaque _nonce_ n'est utilis\u00e9 **qu'une seule fois**.\r\n\r\nLa question que vous devez vous poser pour ce challenge: qu'est-ce qui arrive si le _nonce_ est utilis\u00e9 **plus qu'une fois**?\r\n\r\n\r\n## Pr\u00e9cision sur la g\u00e9n\u00e9ration du keystream\r\nLes m\u00e9thodes utilis\u00e9es pour g\u00e9n\u00e9rer le keystream en CTR peuvent diff\u00e9rer d'une impl\u00e9mentation \u00e0 l'autre. Dans le contexte de ce d\u00e9fi, le nonce est concat\u00e9n\u00e9 au compteur. Donc, pour un compteur d'une valeur de 4 et un nonce de `\\x12\\x34\\x56\\x78\\x9a\\xbc\\xde\\xf0`, on obtient les 16 octets suivants:\r\n\r\n`\\x12\\x34\\x56\\x78\\x9a\\xbc\\xde\\xf0\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04`.\r\n\r\nEnsuite, on chiffre ce bloc de 16 octets pour obtenir le keystream.\r\n\r\n\r\nServeur: `nc challenges.unitedctf.ca 3001`", "connection_info": null, "next_id": null, "category": "Crypto", "state": "visible", "max_attempts": 0, "type": "standard", "type_data": {"id": "standard", "name": "standard", "templates": {"create": "/plugins/challenges/assets/create.html", "update": "/plugins/challenges/assets/update.html", "view": "/plugins/challenges/assets/view.html"}, "scripts": {"create": "/plugins/challenges/assets/create.js", "update": "/plugins/challenges/assets/update.js", "view": "/plugins/challenges/assets/view.js"}}, "solves": 9, "solved_by_me": false, "attempts": 0, "files": ["/files/17143cd836ab81a379e2b60c06959854/server.py", "/files/d1cc6e7fa7a91ec0a9d78077305e149c/requirements.txt"], "tags": [], "hints": [], "view": "<div class=\"modal-dialog\" role=\"document\">\n\t<div class=\"modal-content\">\n\t\t<div class=\"modal-body\">\n\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n\t\t\t\t<span aria-hidden=\"true\">&times;</span>\n\t\t\t</button>\n\t\t\t<ul class=\"nav nav-tabs\">\n\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t<a class=\"nav-link active\" href=\"#challenge\">Challenge</a>\n\t\t\t\t</li>\n\t\t\t\t\n\t\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t\t<a class=\"nav-link challenge-solves\" href=\"#solves\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t9 Solves\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\n\t\t\t</ul>\n\t\t\t<div role=\"tabpanel\">\n\t\t\t\t<div class=\"tab-content\">\n\t\t\t\t\t<div role=\"tabpanel\" class=\"tab-pane fade show active\" id=\"challenge\">\n\t\t\t\t\t\t<h2 class='challenge-name text-center pt-3'>\n\t\t\t\t\t\t\tAES CTR\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<h3 class=\"challenge-value text-center\">\n\t\t\t\t\t\t\t350\n\t\t\t\t\t\t</h3>\n\n\t\t\t\t\t\t<div class=\"challenge-tags text-center\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<span class=\"challenge-desc\"><h1>AES CTR</h1>\n<p>Author: Francis Labelle</p>\n<p>Le mode CTR est un mode de chiffrement permettant de chiffrer des donn\u00e9es en continu (<em>streaming</em>) plut\u00f4t que par blocs comme ECB et CBC. Ainsi, il est possible de chiffrer des donn\u00e9es plus courtes qu'un bloc sans avoir \u00e0 ajouter de padding.</p>\n<p>Avec le mode CTR, on utilise AES non pas sur le texte \u00e0 chiffrer, mais sur un bloc compos\u00e9 d'un <strong>nonce</strong> (<em>number used once</em>, diff\u00e9rent pour chaque plaintext chiffr\u00e9) et d'un compteur qui s'incr\u00e9mente \u00e0 chaque bloc. Le r\u00e9sultat de cette op\u00e9ration est un <em>keystream</em>. On fait ensuite un XOR de chaque octet des donn\u00e9es \u00e0 chiffrer avec chaque octet du <em>keystream</em>.</p>\n<pre><code># G\u00e9n\u00e9ration du keystream:\nkeystream = AES(nonce + compteur) # 16 premiers bytes de keystream\nkeystream += AES(nonce + compteur + 1) # 16 bytes de keystream suivants\nkeystream += AES(nonce + compteur + 2) # etc.\n# ...\n# Jusqu'\u00e0 ce que longueur(keystream) &gt;= longueur(plaintext).\n\n# Chiffrement des donn\u00e9es\nPour chaque byte de plaintext (p) et de keystream (k):\n    ciphertext += p ^ k\n</code></pre>\n<p>La s\u00e9curit\u00e9 de ce mode repose sur la s\u00e9curit\u00e9 du <em>keystream</em>. Cette s\u00e9curit\u00e9 est assur\u00e9e par le compteur et le <em>nonce</em>: le compteur s'assure que les blocs du <em>keystream</em> seront diff\u00e9rents les uns des autres. Le <em>nonce</em> s'assure que le <em>keystream</em> au complet sera diff\u00e9rent pour chaque <em>plaintext</em> \u00e0 chiffrer, tant et aussi longtemps que chaque <em>nonce</em> n'est utilis\u00e9 <strong>qu'une seule fois</strong>.</p>\n<p>La question que vous devez vous poser pour ce challenge: qu'est-ce qui arrive si le <em>nonce</em> est utilis\u00e9 <strong>plus qu'une fois</strong>?</p>\n<h2>Pr\u00e9cision sur la g\u00e9n\u00e9ration du keystream</h2>\n<p>Les m\u00e9thodes utilis\u00e9es pour g\u00e9n\u00e9rer le keystream en CTR peuvent diff\u00e9rer d'une impl\u00e9mentation \u00e0 l'autre. Dans le contexte de ce d\u00e9fi, le nonce est concat\u00e9n\u00e9 au compteur. Donc, pour un compteur d'une valeur de 4 et un nonce de <code>\\x12\\x34\\x56\\x78\\x9a\\xbc\\xde\\xf0</code>, on obtient les 16 octets suivants:</p>\n<p><code>\\x12\\x34\\x56\\x78\\x9a\\xbc\\xde\\xf0\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04</code>.</p>\n<p>Ensuite, on chiffre ce bloc de 16 octets pour obtenir le keystream.</p>\n<p>Serveur: <code>nc challenges.unitedctf.ca 3001</code></p>\n</span>\n\n\t\t\t\t\t\t<span class=\"challenge-connection-info\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t<div class=\"challenge-hints hint-row row\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"row challenge-files text-center pb-3\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class='col-md-4 col-sm-4 col-xs-12 file-button-wrapper d-block'>\n\t\t\t\t\t\t\t\t\t<a class='btn btn-info btn-file mb-1 d-inline-block px-2 w-100 text-truncate'\n\t\t\t\t\t\t\t\t\t   href='/files/17143cd836ab81a379e2b60c06959854/server.py'>\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-download\"></i>\n\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tserver.py\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class='col-md-4 col-sm-4 col-xs-12 file-button-wrapper d-block'>\n\t\t\t\t\t\t\t\t\t<a class='btn btn-info btn-file mb-1 d-inline-block px-2 w-100 text-truncate'\n\t\t\t\t\t\t\t\t\t   href='/files/d1cc6e7fa7a91ec0a9d78077305e149c/requirements.txt'>\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-download\"></i>\n\t\t\t\t\t\t\t\t\t\t<small>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\trequirements.txt\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t<div class=\"row submit-row\">\n\t\t\t\t\t\t\t<div class=\"col-md-9 form-group\">\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<input id=\"challenge-id\" class=\"challenge-id\" type=\"hidden\" value=\"34\">\n\t\t\t\t\t\t\t\t\t<input id=\"challenge-input\" class=\"challenge-input\" type=\"text\" name=\"answer\" placeholder=\"Flag\"/>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-md-3 form-group key-submit\">\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<button id=\"challenge-submit\" class=\"challenge-submit\" type=\"submit\">\n\t\t\t\t\t\t\t\t\tSubmit\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"row notification-row\">\n\t\t\t\t\t\t\t<div class=\"col-md-12\">\n\t\t\t\t\t\t\t\t<div id=\"result-notification\" class=\"alert alert-dismissable text-center w-100\"\n\t\t\t\t\t\t\t\t\t role=\"alert\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t<strong id=\"result-message\"></strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div role=\"tabpanel\" class=\"tab-pane fade\" id=\"solves\">\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"col-md-12\">\n\t\t\t\t\t\t\t\t<table class=\"table table-striped text-center\">\n\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td><b>Name</b>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td><b>Date</b>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t<tbody id=\"challenge-solves-names\">\n\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>"}}
